{"version":3,"file":"/scripts/plugins/woocommerce/wc-wishlist.js","mappings":"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","sources":["webpack://sage/./resources/scripts/plugins/woocommerce/wc-wishlist.js"],"sourcesContent":["(function ($) {\r\n    document.addEventListener('filterProductsByOrder', wishlistInit)\r\n    document.addEventListener('filterProductsByPrice', wishlistInit)\r\n\r\n    \"use strict\";\r\n    let loadingAnimation = \"<span class='addToCart-loader'><div></div><div></div></span>\";\r\n\r\n    Array.prototype.unique = function () {\r\n        return this.filter(function (value, index, self) {\r\n            return self.indexOf(value) === index;\r\n        });\r\n    }\r\n\r\n    function isInArray(value, array) {\r\n        return array.indexOf(value) > -1;\r\n    }\r\n\r\n    function onWishlistComplete(target, title) {\r\n        setTimeout(function () {\r\n            target\r\n                .removeClass('is-loading')\r\n                .attr('title', title);\r\n        }, 500);\r\n    }\r\n\r\n    function highlightWishlist(wishlistIds, title) {\r\n        $('.wishlist-toggle').each(function () {\r\n            let $this = $(this);\r\n            let currentProduct = $this.data('product');\r\n            currentProduct = currentProduct.toString();\r\n            if (isInArray(currentProduct, wishlistIds)) {\r\n                $this.addClass('is-active').attr('title', title);\r\n            }\r\n        });\r\n    }\r\n\r\n    let shopName = woocommerce_params_wishlist.shop_name + '-wishlist',\r\n        inWishlist = woocommerce_params_wishlist.in_wishlist_text,\r\n        restUrl = woocommerce_params_wishlist.rest_url,\r\n        wishlistIds = new Array,\r\n        ls = sessionStorage.getItem(shopName),\r\n        loggedIn = ($('body').hasClass('logged-in')) ? true : false,\r\n        userData = '';\r\n\r\n    if (loggedIn) {\r\n        // Fetch current user data\r\n        fetchWishlistUserData();\r\n    } else {\r\n        if (typeof (ls) != 'undefined' && ls != null) {\r\n            ls = ls.split(',');\r\n            ls = ls.unique();\r\n            wishlistIds = ls;\r\n        }\r\n\r\n        if ($('.wishlist-preview').length > 0) {\r\n            fetchWishlistUserData();\r\n        } else {\r\n            wishlistInit();\r\n        }\r\n    }\r\n\r\n    function fetchWishlistUserData() {\r\n        if ($('.wishlist-preview').is(':empty')) {\r\n            $('.wishlist-preview').append(loadingAnimation);\r\n        }\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: woocommerce_params.ajax_url,\r\n            data: {\r\n                'action': 'fetch_user_data',\r\n                'dataType': 'json',\r\n                'wishlist_ids': wishlistIds\r\n            },\r\n            success: function (data) {\r\n                userData = JSON.parse(data);\r\n                wishlistIds = userData['wishlist_ids'];\r\n\r\n                if ($('.wishlist-preview').length > 0) {\r\n                    if ($('.wishlist-preview .products').length === 0) {\r\n                        $('.wishlist-preview').hide().html(userData['wishlist']).fadeIn();\r\n                    } else {\r\n                        $('.wishlist-preview').html(userData['wishlist']);\r\n                    }\r\n                }\r\n\r\n                if (loggedIn) {\r\n                    sessionStorage.removeItem(shopName);\r\n                }\r\n\r\n                wishlistInit();\r\n\r\n            },\r\n            error: function () {\r\n            }\r\n        });\r\n    }\r\n\r\n    function wishListTrigger($this) {\r\n        $this.on('click', function (e) {\r\n            e.preventDefault();\r\n            if (!$(this).hasClass('is-loading')) {\r\n                $(this).addClass('is-loading');\r\n\r\n                if ($(this).hasClass('is-active')) {\r\n                    $(this).removeClass('is-active');\r\n\r\n                    if ($('body').hasClass('template-wishlist')) {\r\n                        $(this).closest('.product').fadeOut().promise().done(function () {\r\n                            $(this).remove();\r\n                        });\r\n                    }\r\n\r\n                    for (let i = wishlistIds.length - 1; i >= 0; i--) {\r\n                        if (wishlistIds[i] == $(this).data('product')) {\r\n                            wishlistIds.splice(i, 1);\r\n                        }\r\n                    }\r\n                } else {\r\n                    $(this).addClass('is-active')\r\n                    wishlistIds.push($(this).data('product').toString());\r\n                }\r\n\r\n                wishlistIds = wishlistIds.unique().filter(function (v) {\r\n                    return v !== ''\r\n                });\r\n\r\n                if (wishlistIds.length === 0 && $('.wishlist-preview').length > 0) {\r\n                    $('.wishlist-preview').append(loadingAnimation);\r\n                }\r\n\r\n                $('.e-wishlist').attr('data-amount', wishlistIds.length)\r\n\r\n                if (loggedIn) {\r\n                    $.ajax({\r\n                        type: 'POST',\r\n                        url: woocommerce_params_wishlist.ajax_post,\r\n                        data: {\r\n                            action: 'user_wishlist_update',\r\n                            user_id: userData['user_id'],\r\n                            wishlist_ids: wishlistIds.join(','),\r\n                        }\r\n                    })\r\n                        .done(function (response) {\r\n                            if (wishlistIds.length === 0) {\r\n                                fetchWishlistUserData();\r\n                            }\r\n                        })\r\n                        .fail(function (data) {\r\n                            alert(woocommerce_params_wishlist.error_text);\r\n                        });\r\n                } else {\r\n                    sessionStorage.setItem(shopName, wishlistIds.toString());\r\n                    if (wishlistIds.length === 0) {\r\n                        fetchWishlistUserData();\r\n                    }\r\n                }\r\n\r\n                onWishlistComplete($this, inWishlist);\r\n            }\r\n        });\r\n    }\r\n\r\n    wishListTrigger($('.wishlist-toggle'));\r\n\r\n    function wishlistInit() {\r\n        wishlistIds = wishlistIds.filter(function (el) {\r\n            return el != \"\";\r\n        });\r\n        $('.e-wishlist').attr('data-amount', wishlistIds.length)\r\n        $('.wishlist-toggle').each(function () {\r\n            let $this = $(this);\r\n\r\n            if (!loggedIn) {\r\n                let currentProduct = $this.data('product');\r\n                currentProduct = currentProduct.toString();\r\n                if (!loggedIn && isInArray(currentProduct, wishlistIds)) {\r\n                    $this.addClass('is-active').attr('title', inWishlist);\r\n                }\r\n            }\r\n\r\n            wishListTrigger($this);\r\n        });\r\n    }\r\n\r\n    setTimeout(function () {\r\n\r\n        if (wishlistIds.length) {\r\n\r\n            restUrl += '?include=' + wishlistIds.join(',');\r\n            restUrl += '&per_page=' + wishlistIds.length;\r\n\r\n            $.ajax({\r\n                dataType: 'json',\r\n                url: restUrl\r\n            })\r\n                .done(function (response) {\r\n\r\n                })\r\n                .fail(function (response) {\r\n                    alert(woocommerce_params_wishlist.no_wishlist_text);\r\n                })\r\n        }\r\n\r\n    }, 1000);\r\n})(jQuery);\r\n"],"names":["$","document","addEventListener","wishlistInit","loadingAnimation","isInArray","value","array","indexOf","Array","prototype","unique","this","filter","index","self","shopName","woocommerce_params_wishlist","shop_name","inWishlist","in_wishlist_text","restUrl","rest_url","wishlistIds","ls","sessionStorage","getItem","loggedIn","hasClass","userData","fetchWishlistUserData","is","append","ajax","type","url","woocommerce_params","ajax_url","data","success","JSON","parse","length","hide","html","fadeIn","removeItem","error","wishListTrigger","$this","on","e","preventDefault","addClass","removeClass","closest","fadeOut","promise","done","remove","i","splice","push","toString","v","attr","ajax_post","action","user_id","wishlist_ids","join","response","fail","alert","error_text","setItem","target","title","setTimeout","el","each","currentProduct","split","dataType","no_wishlist_text","jQuery"],"sourceRoot":""}